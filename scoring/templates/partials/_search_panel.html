<div class="row mt-4">
  <div class="col-md-6">
    {% load widget_tweaks %}
    <form
      hx-get="{% url 'scoring:search_results' %}"
      hx-target="#search-results"
      autocomplete="off"
      action="{% url 'scoring:search_results' %}" 
      method="get"
    >
      <div class="d-flex flex-row flex-wrap">
        <div class="form-group col-md-2">
          {{ filter.form.Card.label_tag }}{% render_field filter.form.Card class="form-control" %}
        </div>
        <div class="form-group col-md-2">
          {{ filter.form.LOC.label_tag }}{% render_field filter.form.LOC class="form-control" %}
        </div>
        <div class="form-group col-md-2">
          {{ filter.form.Cont.label_tag }}{% render_field filter.form.Cont class="form-control" %}
        </div>
        <div class="form-group col-md-2">
          {{ filter.form.FQ.label_tag }}{% render_field filter.form.FQ class="form-control" %}
        </div>
        <div class="form-group col-md-3">
          {{ filter.form.Determinants.label_tag }}{% render_field filter.form.Determinants class="form-control" %}
        </div>
        <div class="form-group col-md-1">
          {{ filter.form.Item.label_tag }}{% render_field filter.form.Item class="form-control" %}
        </div>
        <div class="form-group col-md-2">
          &lt;{{ filter.form.V.label_tag }}{% render_field filter.form.V class="form-control" %}
        </div>

        <div class="w-100"></div>
        <button type="submit" class="btn btn-primary mt-2">검색</button>
      </div>
    </form>

    <div class="table-wrapper mt-3" style="height:200px">
      <table class="table table-bordered table-sm">
        <thead>
        <tr>
          <th>Card</th><th>LOC</th><th>Cont</th><th>FQ</th><th>Determinants</th><th>Item</th><th>&lt;V</th>
        </tr>
        </thead>
        <tbody>
        {% for SearchReference in filter.qs %}
          <tr>
            <td>{{ SearchReference.Card }}</td>
            <td>{{ SearchReference.LOC }}</td>
            <td>{{ SearchReference.Cont }}</td>
            <td>{{ SearchReference.FQ }}</td>
            <td>{{ SearchReference.Determinants }}</td>
            <td>{{ SearchReference.Item }}</td>
            <td>{{ SearchReference.V }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="7">No data</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="mt-3">
      <table class="table table-bordered table-sm mb-0">
        <thead><tr><th style="width:50%">P</th><th style="width:50%">Z점수</th></tr></thead>
        <tbody>
        {% for PopularResponse in p_response_filter.qs %}
          {% if forloop.first %}
            <tr><td>{{ PopularResponse.p }}</td><td>{{ PopularResponse.Z }}</td></tr>
          {% endif %}
        {% empty %}
          <tr><td colspan="2">No data</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="col-md-6">
    <div class="image-container d-flex flex-wrap" style="max-height:270px; overflow-y:auto; overflow-x:hidden;">
      {% if image_filter.qs %}
        {% for image in image_filter.qs %}
          <div class="m-1" style="width:calc(25% - 10px); overflow:hidden;">
            <img src="{{ image.img_file.url }}" alt="Image" style="max-width:100%; height:auto; display:block;">
          </div>
        {% endfor %}
        {% if not image_filter.qs|length|divisibleby:4 %}
          <div class="m-1" style="width:calc(25% - 10px); background:#fff;">&nbsp;</div>
        {% endif %}
      {% endif %}
    </div>
  </div>

  <div id="search-results" class="container-fluid mt-3"></div>
</div>
